(function(){var g,N=[].indexOf||function(g){for(var p=0,v=this.length;p<v;p++)if(p in this&&this[p]===g)return p;return-1};window.random=function(g,p){return null!=p?Math.round(Math.random()*(p-g))+g:Math.round(Math.random()*g)};window[g]=g={movingObjects:{},gravityObjects:{},lastUpdate:0,gravity:1,nextID:1,init:function(){var x,p,v,y,z,w,u,A,n,B,C,D,E,F,G,H,I,J,K,L,m,M,h;window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(d,b){return window.setTimeout(d,16)}}();n=function(d){var b;b=d.data("iid");null==b&&(b=g.nextID++,d.data("iid",b));return null!=g.movingObjects[b]?g.movingObjects[b]:{id:b,obj:d,speed:1,moveTo:null,autoRemoveOffScreen:!0,angle:0,vY:0}};A=function(d){var b;b=d.data("iid");null==b&&(b=g.nextID++,d.data("iid",b));return null!=g.gravityObjects[b]?g.gravityObjects[b]:{id:b,obj:d,gravity:1}};p=function(){var d,b,c,e,f,h,k,t,s,n,a,
l,r;if((new Date).getTime()>g.lastUpdate+16){r=$(window).width();l=$(window).height();s=g.movingObjects;for(h in s)a=s[h],null!=a.collisionOccured&&0<a.collisionOccured&&a.collisionOccured--,a.moveToNow=a.moveTo;s=g.movingObjects;for(h in s){a=s[h];f=a.obj.position();a.x=f.left;a.y=f.top;k=!1;e=null!=a.speed?a.speed/100*(r+l):0;if("number"===typeof a.moveToNow){for(;360<a.moveToNow;)a.moveToNow-=360;for(;-360>a.moveToNow;)a.moveToNow+=360;d=a.angle=a.moveToNow*(Math.PI/180);a.x+=Math.cos(d-Math.PI/
2)*e;a.y+=Math.sin(d-Math.PI/2)*e;a.obj.css("left",a.x+"px").css("top",a.y+"px");g.movingObjects[h]=a;k=!0}else if(Array.isArray(a.moveToNow)){k=a.x;t=a.y;d=a.moveToNow[0]-a.x;b=a.y-a.moveToNow[1];d=a.angle=Math.atan2(d,b);k!==a.moveToNow[0]&&(a.x+=Math.cos(d-Math.PI/2)*e);t!==a.moveToNow[1]&&(a.y+=Math.sin(d-Math.PI/2)*e);if(k<=a.moveToNow[0]&&a.x>=a.moveToNow[0]||k>=a.moveToNow[0]&&a.x<=a.moveToNow[0])a.x=a.moveToNow[0];if(t<=a.moveToNow[1]&&a.y>=a.moveToNow[1]||t>=a.moveToNow[1]&&a.y<=a.moveToNow[1])a.y=
a.moveToNow[1];a.obj.css("left",a.x+"px").css("top",a.y+"px");if(a.x===a.moveToNow[0]&&a.y===a.moveToNow[1]){if(a.onMoveTo)try{a.onMoveTo()}finally{a.onMoveTo=null}a.angle=null}g.movingObjects[h]=a;k=!0}else if(null!=a.moveToNow&&("string"===typeof a.moveToNow||"object"===typeof a.moveToNow&&"function"===typeof a.moveToNow.position)&&(f="string"===typeof a.moveToNow?$(a.moveToNow):a.moveToNow,f=f.position(),null!=f)){k=a.x;t=a.y;d=f.left-a.x;b=a.y-f.top;d=a.angle=Math.atan2(d,b);k!==f.left&&(a.x+=
Math.cos(d-Math.PI/2)*e);t!==f.top&&(a.y+=Math.sin(d-Math.PI/2)*e);if(k<=f.left&&a.x>=f.left||k>=f.left&&a.x<=f.left)a.x=f.left;if(t<=f.top&&a.y>=f.top||t>=f.top&&a.y<=f.top)a.y=f.top;a.obj.css("left",a.x+"px").css("top",a.y+"px");if(a.x===f.left&&a.y===f.top&&a.onMoveTo)try{a.onMoveTo()}finally{a.onMoveTo=null}g.movingObjects[h]=a;k=!0}null!=a.weight&&(e=a.obj.closest(".scene"),e=0<e.length&&null!=e.data("iid")?gravityObjects[null!=e.data("iid")]:null,e=null!=e&&null!=e.gravity&&"number"===typeof e.gravity?
e.gravity:g.gravity,null==a.vy&&(a.vy=0),a.vy+=e,a.y+=a.vy,a.obj.css("top",a.y+"px"),g.movingObjects[h]=a,k=!0);if(k&&(a.autoRemoveOffScreen||null!=a.onOffScreen)&&(f=a.obj.width(),e=a.obj.width(),0>a.x+f||0>a.y+e||a.x>r||a.y>l)){a.autoRemoveOffScreen&&a.obj.remove();try{null!=(n=a.onOffScreen)&&n.apply(a.obj)}catch(q){}}k=g.movingObjects;for(c in k)if(e=k[c],c!==h&&(null!=a.onCollision||null!=e.onCollision||a.autoBounceBack||e.autoBounceBack||a.autoBounceOff||e.autoBounceOff)&&(!e.collisionOccured||
0>=e.collisionOccured)&&(!a.collisionOccured||0>=a.collisionOccured)&&a.obj.isCollision(e.obj)){a.collisionOccured=3;e.collisionOccured=3;if(null!=a.onCollision)try{a.onCollision(e.obj)}catch(m){f=m,console.log(f)}if(null!=e.onCollision)try{e.onCollision(a.obj)}catch(u){}a.autoBounceBack?a.obj.bounceBack(e.obj):a.autoBounceOff&&a.obj.bounceOff(e.obj);e.autoBounceBack?e.obj.bounceBack(a.obj):e.autoBounceOff&&e.obj.bounceOff(a.obj)}}g.lastUpdate=(new Date).getTime()}return requestAnimFrame(p)};m=function(){var d,
b,c,e,f;c=document.getElementsByTagName("body")[0].getElementsByTagName("*");f=g.movingObjects;for(e in f)b=f[e],jQuery.contains(document,b.obj[0])||delete g.movingObjects[b.id];f=[];b=0;for(e=c.length;b<e;b++)d=c[b],d=$(d),null==d.data("iid")?(d=n(d),f.push(g.movingObjects[d.id]=d)):f.push(void 0);return f};m();requestAnimFrame(p);h={};w=u=void 0;M=function(d,b,c,e){var f,g;f=Math.abs(d-b);g=Math.abs(c-e);return f>=g?0<d-b?"Left":"Right":0<c-e?"Up":"Down"};z=function(d){u=Date.now();w=u-(h.last||
u);h.el=$(parentIfText(d.touches[0].target));h.x1=d.touches[0].pageX;h.y1=d.touches[0].pageY;0<w&&250>=w&&(h.isDoubleTap=!0);return h.last=u};y=function(d){h.x2=d.touches[0].pageX;return h.y2=d.touches[0].pageY};v=function(d){if(h.isDoubleTap)return h={},"doubleTap";if(h.x2&&30<Math.abs(h.x1-h.x2)||h.y2&&30<Math.abs(h.y1-h.y2))return h={},"swipe"+M(h.x1,h.x2,h.y1,h.y2);if("last"in h)return h={},"tap";h={};return""};x=(B=!!(0<=N.call(window,"ontouchstart")))?"touchend":"click";C=jQuery.fn.add;E=jQuery.fn.append;
F=jQuery.fn.appendTo;I=jQuery.fn.html;J=jQuery.fn.prepend;K=jQuery.fn.prependTo;L=jQuery.fn.remove;H=jQuery.fn.empty;G=jQuery.fn.before;D=jQuery.fn.after;return function(d){d.fn.add=function(){var b;b=C.apply(this,arguments);m();return b};d.fn.append=function(){var b;b=E.apply(this,arguments);m();return b};d.fn.appendTo=function(){var b;b=F.apply(this,arguments);m();return b};d.fn.html=function(){var b;b=I.apply(this,arguments);m();return b};d.fn.prepend=function(){var b;b=J.apply(this,arguments);
m();return b};d.fn.prependTo=function(){var b;b=K.apply(this,arguments);m();return b};d.fn.empty=function(){var b;b=H.apply(this,arguments);m();return b};d.fn.before=function(){var b;b=G.apply(this,arguments);m();return b};d.fn.after=function(){var b;b=D.apply(this,arguments);m();return b};d.fn.remove=function(){var b;b=L.apply(this,arguments);m();return b};d.fn.isCollision=function(b){var c,e,g,h,k,n,s,m,a;"string"===typeof b&&(b=d(b));m=this.css("z-index");h=this.offset().left;n=this.offset().top;
c=this.outerHeight(!0);e=this.outerWidth(!0);c=n+c;g=h+e;a=b.css("z-index");k=b.offset().left;s=b.offset().top;e=b.outerHeight(!0);b=b.outerWidth(!0);return m!==a||c<s||n>s+e||g<k||h>k+b?!1:!0};d.fn.onCollision=function(b){return this.each(function(){var c;c=d(this);c=n(c);c.onCollision=b;return g.movingObjects[c.id]=c})};d.fn.tap=function(b){return this.on(x,function(b){b.preventDefault();return b.stopPropagation()})};d.fn.speed=function(b){return this.each(function(){var c;c=d(this);c=n(c);c.speed=
b;return g.movingObjects[c.id]=c})};d.fn.moveTo=function(b,c){return this.each(function(){var e;e=d(this);e=n(e);e.moveTo=null!=c?[b,c]:b;return g.movingObjects[e.id]=e})};d.fn.autoBounceBack=function(b){return this.each(function(){var c;c=n(d(this));c.autoBounceBack=null!=b?b:!0;return g.movingObjects[c.id]=c})};d.fn.autoBounceOff=function(b){return this.each(function(){var c;c=n(d(this));c.autoBounceOff=null!=b?b:!0;return g.movingObjects[c.id]=c})};d.fn.bounceBack=function(b){return this.each(function(){var c,
e;e=n(d(this));null==e.moveTo&&null!=b?(c=n(d(b)),null!=c.angle&&(e.moveTo=c.angle*(180/Math.PI))):null!=e.moveTo&&(c=e.angle>Math.PI?e.angle-Math.PI:e.angle+Math.PI,e.moveTo=c*(180/Math.PI));return g.movingObjects[e.id]=e})};d.fn.bounceOff=function(b){var c,e,f,h,k,m;e=d(b);k=e.offset().left;m=e.offset().top;f=e.outerHeight(!0);e=e.outerWidth(!0);c=m+f;h=k+e;return this.each(function(){var e,f,a,l,r,q,p;r=n(d(this));if(null==r.moveTo&&null!=b){if(q=n(d(b)),null!=q.angle)return r.moveTo=q.angle*(180/
Math.PI)}else if(null!=r.angle)return a=r.obj,q=a.offset().left,f=a.offset().top,l=a.outerHeight(!0),a=a.outerWidth(!0),e=f+l,p=q+a,l=r.angle*(180/Math.PI),0>l&&(l+=360),0===l||90===l||180===l||270===l||360===l?l-=180:(a=Math.abs(e<m?m-e:f-c),f=Math.abs(f>c?f-c:m-e),e=Math.abs(p<k?k-p:q-h),q=Math.abs(q>h?q-h:k-p),console.log("Edges: top: "+a+", bottom: "+f+", left: "+e+", right: "+q+", "),Math.min(e,q)<Math.min(a,f)?(console.log("Vertical wall"),q=0):(console.log("Horizontal wall"),q=90),l=(2*q-l)*
(Math.PI/180),q=1*Math.cos(l),l=1*Math.sin(l),l=180*Math.atan2(l,q)/Math.PI),r.moveTo=l,g.movingObjects[r.id]=r})};d.fn.onMoveComplete=function(b){return this.each(function(){var c;c=d(this);c=n(c);c.onMoveTo=b;return g.movingObjects[c.id]=c})};d.fn.autoRemoveOffScreen=function(b){return this.each(function(){var c;c=n(d(this));c.autoRemoveOffScreen=null!=b?b:!0;return g.movingObjects[c.id]=c})};d.fn.onOffScreen=function(b){return this.each(function(){var c;c=d(this);c=n(c);c.onOffScreen=b;return g.movingObjects[c.id]=
c})};d.fn.displayScene=function(){};d.fn.weight=function(b){return this.each(function(){var c;c=d(this);c=n(c);return null!=b?(c.weight=b,g.movingObjects[c.id]=c,this):null!=(null!=c?c.weight:void 0)})};d.fn.gravity=function(b){return 0===this.length?g.gravity=b:this.each(function(){var c;c=d(this);c=A(c);c.gravity=b;return g.gravityObjects[c.id]=c})};return d.fn.onTap=function(b,c){return B?(this.on("touchstart",function(b){isAndroid&&b.preventDefault();z(window.event);if("function"===typeof c)return c(b)}),
this.on("touchmove",function(b){return y(window.event)}),this.on("touchend",function(c){window.event.preventDefault();window.event.stopPropagation();if("function"===typeof functionCall&&!("tap"!==v(window.event)||has(child.data("ui"))&&has(child.data("ui").disabled)))return b(c)})):this.on(x,function(c){c.preventDefault();c.stopPropagation();return b(c,this)})}}(jQuery)}};$(document).ready(function(){return g.init()})}).call(this);
